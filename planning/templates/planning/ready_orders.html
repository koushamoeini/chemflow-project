{% extends "base.html" %}
{% block title %}Ø³ÙØ§Ø±Ø´â€ŒÙ‡Ø§ÛŒ Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ø±Ù†Ø§Ù…Ù‡â€ŒØ±ÛŒØ²ÛŒ{% endblock %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="{% static 'css/list_styles.css' %}">
<div class="container mt-4" dir="rtl">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="m-0">Ø³ÙØ§Ø±Ø´â€ŒÙ‡Ø§ÛŒ ØªØ£ÛŒÛŒØ¯Ø´Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ø¨Ø±Ù†Ø§Ù…Ù‡â€ŒØ±ÛŒØ²ÛŒ</h2>

        {# Ø¯Ú©Ù…Ù‡ Ø§ØµÙ„ÛŒ Ø¨Ø±Ø§ÛŒ Ù‡Ù…Ø§Ù‡Ù†Ú¯ÛŒ Ø¨Ø§ ØªÙ… Ø¨Ù‡ btn-primary ØªØºÛŒÛŒØ± Ú©Ø±Ø¯ #}
        {% if role == 'factory_planner' or role == 'management' %}
        <a href="{% url 'planning:prodreq_create' %}" class="btn btn-primary">
            â• Ø¯Ø±Ø®ÙˆØ§Ø³Øª ØªÙˆÙ„ÛŒØ¯ Ø¬Ø¯ÛŒØ¯
        </a>
        {% endif %}
    </div>

    <div class="table-responsive">
        {# Ú©Ù„Ø§Ø³ table-striped Ø­Ø°Ù Ùˆ table-hover Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯ #}
        <table class="table table-hover align-middle">
            <thead class="table-light">
            <tr>
                <th>Ø´Ù…Ø§Ø±Ù‡ Ø³ÙØ§Ø±Ø´</th>
                <th>Ù…Ø´ØªØ±ÛŒ</th>
                <th>Ù…Ø­ØµÙˆÙ„</th>
                <th>ØªØ§Ø±ÛŒØ®</th>
                <th>ÙˆØ¶Ø¹ÛŒØª Ø¨Ø±Ù†Ø§Ù…Ù‡â€ŒØ±ÛŒØ²ÛŒ</th>
                <th>Ø¹Ù…Ù„ÛŒØ§Øª</th>
            </tr>
            </thead>
            <tbody>
            {% for o in orders %}
            <tr>
                <td>{{ o.order_number }}</td>
                <td>{{ o.customer_name }}</td>
                <td>
                    {% for item in o.items.all %}
                    {{ item.product_name }}{% if not forloop.last %}, {% endif %}
                    {% empty %}
                    â€”
                    {% endfor %}
                </td>
                <td>{{ o.created_at|date:"Y-m-d" }}</td>
                <td>
                    {% if o.planning_status.is_planned %}
                    <span class="badge bg-success">âœ… Ø¨Ø±Ù†Ø§Ù…Ù‡â€ŒØ±ÛŒØ²ÛŒ Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯</span>
                    {% else %}
                    <span class="badge bg-warning text-dark">ğŸŸ¡ Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ø±Ù†Ø§Ù…Ù‡â€ŒØ±ÛŒØ²ÛŒ</span>
                    {% endif %}
                </td>
                <td class="d-flex gap-2">
                    <a href="{% url 'orders:order_details' o.pk %}?return_to=ready_orders"
                       class="btn btn-sm btn-outline-primary">
                        Ø¬Ø²Ø¦ÛŒØ§Øª Ø³ÙØ§Ø±Ø´
                    </a>

                    {% if role == 'factory_planner' or role == 'management' %}
                    <a href="{% url 'planning:prodreq_create' %}?order={{ o.pk }}" class="btn btn-sm btn-success">
                        Ø§ÛŒØ¬Ø§Ø¯ Ø¯Ø±Ø®ÙˆØ§Ø³Øª ØªÙˆÙ„ÛŒØ¯
                    </a>
                    {% endif %}

                    {% if role == 'factory_planner' or role == 'management' or role == 'factory_manager' %}
                    {% if o.planning_status.is_planned %}
                    <a href="{% url 'planning:toggle_planning' o.pk %}" class="btn btn-sm btn-warning">
                        â†©ï¸ Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø¢Ù…Ø§Ø¯Ù‡
                    </a>
                    {% else %}
                    <a href="{% url 'planning:toggle_planning' o.pk %}" class="btn btn-sm btn-info">
                        âœ… ØªÚ©Ù…ÛŒÙ„ Ø¨Ø±Ù†Ø§Ù…Ù‡â€ŒØ±ÛŒØ²ÛŒ
                    </a>
                    {% endif %}
                    {% endif %}
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="6" class="text-muted text-center">Ù‡ÛŒÚ† Ø³ÙØ§Ø±Ø´ÛŒ Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ø±Ù†Ø§Ù…Ù‡â€ŒØ±ÛŒØ²ÛŒ Ù†ÛŒØ³Øª.</td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}